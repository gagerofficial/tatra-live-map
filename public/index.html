<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>PROJECT GOB | BLACK OPS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<style>
:root{
    --accent:#a855f7;
    --ok:#22c55e;
    --warn:#facc15;
    --bad:#ef4444;
    --bg:#050507;
    --panel:#0b0b10;
    --border:#1f1f26;
    --grid:rgba(255,255,255,.03);
    --text:#e5e7eb;
    --dim:#6b7280;
}

*{margin:0;padding:0;box-sizing:border-box}
body{
    background:var(--bg);
    color:var(--text);
    font-family:Inter,system-ui;
}

/* NAV */
nav{
    height:64px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 6%;
    background:#030305;
    border-bottom:1px solid var(--border);
}
nav b{
    color:var(--accent);
    letter-spacing:2px;
    font-size:18px;
}
nav span{
    color:var(--dim);
    font-size:12px;
}

/* SECTIONS */
section{display:none;padding:40px 6%;min-height:90vh}
section.active{display:block}

/* RADAR LAYOUT */
#layout{
    display:flex;
    gap:16px;
    margin-top:20px;
    height:680px;
}

/* MAP */
#map{
    flex:3;
    position:relative;
    background:#060609;
    border:1px solid var(--border);
    overflow:hidden;
}

/* GRID */
#map::before{
    content:"";
    position:absolute;
    inset:0;
    background:
        linear-gradient(var(--grid) 1px,transparent 1px),
        linear-gradient(90deg,var(--grid) 1px,transparent 1px);
    background-size:40px 40px;
    pointer-events:none;
}

/* SCAN LINE */
#map::after{
    content:"";
    position:absolute;
    inset:0;
    background:linear-gradient(
        180deg,
        transparent,
        rgba(168,85,247,.08),
        transparent
    );
    animation:scan 6s linear infinite;
    pointer-events:none;
}
@keyframes scan{
    from{transform:translateY(-100%)}
    to{transform:translateY(100%)}
}

/* SVG NETWORK */
#network{
    position:absolute;
    inset:0;
    opacity:.9;
}

/* VEHICLE */
.tram{
    position:absolute;
    width:12px;
    height:34px;
    border:2px solid black;
    border-radius:2px;
    z-index:10;
    box-shadow:0 0 12px rgba(0,0,0,.8);
}

/* HEATMAP */
.heat{
    position:absolute;
    width:180px;
    height:180px;
    border-radius:50%;
    background:radial-gradient(circle,
        rgba(239,68,68,.5) 0%,
        rgba(239,68,68,.25) 35%,
        rgba(239,68,68,0) 70%);
    mix-blend-mode:screen;
    pointer-events:none;
}

/* PANEL */
#side{
    flex:1;
    background:var(--panel);
    border:1px solid var(--border);
    padding:20px;
    display:flex;
    flex-direction:column;
    gap:20px;
}
.block{
    border-left:3px solid var(--accent);
    padding-left:12px;
}
.block h3{
    font-size:12px;
    letter-spacing:1px;
    color:var(--accent);
    margin-bottom:10px;
}
.block p{
    font-size:13px;
    color:var(--dim);
    line-height:1.4;
}
</style>
</head>

<body>

<nav>
    <b>PROJECT GOB</b>
    <span>BLACK OPS RADAR MODE</span>
</nav>

<section class="active">

<h1 style="letter-spacing:2px">LIVE NETWORK SURVEILLANCE</h1>

<div id="layout">

<div id="map">

<svg id="network" viewBox="0 0 800 600">
    <polyline points="60,300 240,280 420,300 600,330 760,320"
        stroke="#a855f7" stroke-width="4" fill="none"/>
    <polyline points="400,60 410,260 400,440 390,560"
        stroke="#22c55e" stroke-width="4" fill="none"/>
</svg>

</div>

<div id="side">

<div class="block">
    <h3>TELEMETRY</h3>
    <p id="telemetry">NO VEHICLE SELECTED</p>
</div>

<div class="block">
    <h3>NETWORK STATUS</h3>
    <p id="status">AWAITING DATA STREAMâ€¦</p>
</div>

</div>

</div>
</section>

<script>
const socket = io();
const vehicles = {};
const map = document.getElementById('map');
let congestion = 0;

/* PLAYER UPDATES ONLY */
socket.on('tramUpdate', data => {

    if(!vehicles[data.id]){
        const el = document.createElement('div');
        el.className = 'tram';
        map.appendChild(el);

        el.onclick = () => {
            document.getElementById('telemetry').innerHTML = `
            LINE: ${data.line}<br>
            DRIVER: ${data.driver}<br>
            SPEED: ${data.speed} km/h
            `;
        };

        vehicles[data.id] = el;
    }

    const v = vehicles[data.id];
    const scale = 0.08;

    const x = 400 + data.x * scale;
    const y = 300 + data.z * scale;

    v.style.left = x + 'px';
    v.style.top = y + 'px';
    v.style.transform = `translate(-50%,-50%) rotate(${data.heading}deg)`;

    /* STATE COLOR */
    if(data.speed < 5){
        v.style.background = 'var(--bad)';
        congestion++;

        const h = document.createElement('div');
        h.className = 'heat';
        h.style.left = (x-90)+'px';
        h.style.top = (y-90)+'px';
        map.appendChild(h);
        setTimeout(()=>h.remove(),4000);
    }
    else if(data.speed < 15){
        v.style.background = 'var(--warn)';
    }
    else{
        v.style.background = 'var(--ok)';
    }
});

/* NETWORK ANALYSIS */
setInterval(()=>{
    const status = document.getElementById('status');

    if(congestion > 6){
        status.innerText = "CRITICAL CONGESTION DETECTED. IMMEDIATE ACTION REQUIRED.";
    }
    else if(congestion > 2){
        status.innerText = "DELAY POCKETS FORMING. MONITOR INTERSECTIONS.";
    }
    else{
        status.innerText = "NETWORK STABLE. ALL SYSTEMS NOMINAL.";
    }

    congestion = 0;
},1000);
</script>

</body>
</html>

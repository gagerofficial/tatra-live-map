<!DOCTYPE html>
<html>
<head>
    <title>Tatra T5C5 Live Radar</title>
    <style>
        body { margin: 0; background: #1a1a1a; color: white; font-family: sans-serif; overflow: hidden; }
        #map { width: 100vw; height: 100vh; position: relative; background: #222; }
        .tram { 
            position: absolute; width: 12px; height: 30px; 
            background: #ffcc00; border: 2px solid #000;
            transition: all 1s linear; border-radius: 3px;
        }
        .label { position: absolute; font-size: 10px; background: rgba(0,0,0,0.7); padding: 2px; transform: translateY(-20px); white-space: nowrap;}
        #sidebar { position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.8); padding: 15px; border-radius: 8px; width: 250px; }
    </style>
</head>
<body>
    <div id="sidebar">
        <h2>Live Dispatcher</h2>
        <div id="tram-list">Várakozás adatokra...</div>
    </div>
    <div id="map"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const map = document.getElementById('map');
        const list = document.getElementById('tram-list');
        const tramElements = {};

        socket.on('tramUpdate', (data) => {
            // Villamos létrehozása vagy frissítése a térképen
            if (!tramElements[data.id]) {
                const el = document.createElement('div');
                el.className = 'tram';
                el.innerHTML = `<div class="label">${data.line} - ${data.driver}</div>`;
                map.appendChild(el);
                tramElements[data.id] = el;
            }
            
            // Pozícionálás (A Roblox X,Z koordinátáit le kell skáláznod a térképedre)
            const scale = 0.5; // Állítsd be a mapod méretéhez
            tramElements[data.id].style.left = (window.innerWidth/2 + data.x * scale) + 'px';
            tramElements[data.id].style.top = (window.innerHeight/2 + data.z * scale) + 'px';
            tramElements[data.id].style.transform = `rotate(${data.heading}deg)`;
            
            updateSidebar(data);
        });

        function updateSidebar(data) {
            list.innerHTML = `<b>Járatszám:</b> ${data.line}<br><b>Vezető:</b> ${data.driver}<br><b>Sebesség:</b> ${data.speed} km/h`;
        }
    </script>
</body>
</html>
